<!doctype html><html lang=en-us dir=ltr><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="Extractor de colores Winsor & newton # by FredyRosero
Este sketch de P5 posteriza la imagen para limitar 4 colores por canal. Luego agrega el valor RGB de cada pixel sin repetir a una lista que luego aproximara a otros valores RGB que se &ldquo;aproximan&rdquo; a los colores de las pinturas de óleo Winsor & newton &ldquo;Artists&rsquo; Oil Colour&rdquo; extraidos de https://color-term.com/winsornewton-colors/
El diccionario de colores /showcase/sketches/colores.json se generó con el siguiente scrapper de python:"><meta name=theme-color content="#FFFFFF"><meta name=color-scheme content="light dark"><meta property="og:title" content><meta property="og:description" content="Extractor de colores Winsor & newton # by FredyRosero
Este sketch de P5 posteriza la imagen para limitar 4 colores por canal. Luego agrega el valor RGB de cada pixel sin repetir a una lista que luego aproximara a otros valores RGB que se &ldquo;aproximan&rdquo; a los colores de las pinturas de óleo Winsor & newton &ldquo;Artists&rsquo; Oil Colour&rdquo; extraidos de https://color-term.com/winsornewton-colors/
El diccionario de colores /showcase/sketches/colores.json se generó con el siguiente scrapper de python:"><meta property="og:type" content="article"><meta property="og:url" content="https://computacionvisualgrupo.github.io/showcase/docs/primer-corte/extractor-de-pinturas/"><meta property="article:section" content="docs"><meta property="article:modified_time" content="2023-05-16T07:04:23-05:00"><title>Extractor De Pinturas | Showcase Template Group</title><link rel=manifest href=/showcase/manifest.json><link rel=icon href=/showcase/favicon.png type=image/x-icon><link rel=stylesheet href=/showcase/book.min.4b35fed0bea034bbc19c89c71e14b73fb9c68cfcc586b9382adfb9b7b103ba06.css integrity="sha256-SzX+0L6gNLvBnInHHhS3P7nGjPzFhrk4Kt+5t7EDugY=" crossorigin=anonymous><script defer src=/showcase/flexsearch.min.js></script>
<script defer src=/showcase/en.search.min.3a8d658c77eb93c7f12a2b8af49a700131e474f288eefb605d9fa61576dbe5a7.js integrity="sha256-Oo1ljHfrk8fxKiuK9JpwATHkdPKI7vtgXZ+mFXbb5ac=" crossorigin=anonymous></script></head><body dir=ltr><input type=checkbox class="hidden toggle" id=menu-control>
<input type=checkbox class="hidden toggle" id=toc-control><main class="container flex"><aside class=book-menu><div class=book-menu-content><nav><h2 class=book-brand><a class="flex align-center" href=/showcase/><span>Showcase Template Group</span></a></h2><div class=book-search><input type=text id=book-search-input placeholder=Search aria-label=Search maxlength=64 data-hotkeys=s/><div class="book-search-spinner hidden"></div><ul id=book-search-results></ul></div><ul><li><input type=checkbox id=section-a61b294d5fe4a63fddde070933328b8a class=toggle>
<label for=section-a61b294d5fe4a63fddde070933328b8a class="flex justify-between"><a href=/showcase/docs/about/>About</a></label><ul><li><a href=/showcase/docs/about/Fredy/>Fredy</a></li><li><a href=/showcase/docs/about/Harold/>Harold</a></li><li><a href=/showcase/docs/about/Sergio/>Sergio</a></li></ul></li><li class=book-section-flat><span>Primer Corte</span><ul><li><a href=/showcase/docs/primer-corte/color/>Color</a></li><li><a href=/showcase/docs/primer-corte/extractor-de-pinturas/ class=active>Extractor De Pinturas</a></li><li><a href=/showcase/docs/primer-corte/pixelator/>Pixelator</a></li><li><a href=/showcase/docs/primer-corte/Spiral/>Spiral</a></li></ul></li><li class=book-section-flat><span>Testing</span><ul><li><a href=/showcase/docs/testing/P5-barberpole/>P5 Barberpole</a></li><li><a href=/showcase/docs/testing/P5-ejercicio1/>P5 Ejercicio1</a></li><li><a href=/showcase/docs/testing/P5-hello-world/>P5 Hello World</a></li><li><a href=/showcase/docs/testing/p5Testing2/>P5 Testing2</a></li></ul></li></ul><ul><li><a href=/showcase/posts/>Blog</a></li></ul></nav><script>(function(){var e=document.querySelector("aside .book-menu-content");addEventListener("beforeunload",function(){localStorage.setItem("menu.scrollTop",e.scrollTop)}),e.scrollTop=localStorage.getItem("menu.scrollTop")})()</script></div></aside><div class=book-page><header class=book-header><div class="flex align-center justify-between"><label for=menu-control><img src=/showcase/svg/menu.svg class=book-icon alt=Menu></label>
<strong>Extractor De Pinturas</strong>
<label for=toc-control><img src=/showcase/svg/toc.svg class=book-icon alt="Table of Contents"></label></div><aside class="hidden clearfix"><nav id=TableOfContents><ul><li><a href=#extractor-de-colores-winsor--newton>Extractor de colores Winsor & newton</a></li></ul></nav></aside></header><article class=markdown><h1 id=extractor-de-colores-winsor--newton>Extractor de colores Winsor & newton
<a class=anchor href=#extractor-de-colores-winsor--newton>#</a></h1><p>by <a href=/showcase/docs/about/Fredy/>FredyRosero</a></p><img width=250px src="https://cdn.shopify.com/s/files/1/0048/4245/5158/products/2_a0647768-69c7-4215-bc29-6fffd875b91d_1200x1200.png?v=1679960445"><p>Este sketch de P5 posteriza la imagen para limitar 4 colores por canal. Luego agrega el valor RGB de cada pixel sin repetir a una lista que luego aproximara a otros valores RGB que se &ldquo;aproximan&rdquo; a los colores de las pinturas de óleo Winsor & newton &ldquo;Artists&rsquo; Oil Colour&rdquo; extraidos de <a href=https://color-term.com/winsornewton-colors/>https://color-term.com/winsornewton-colors/</a></p><iframe id=breath style=width:1000px;height:450px srcdoc='
        <!DOCTYPE html>
        <html>
          <head>
            <script src=https://cdnjs.cloudflare.com/ajax/libs/p5.js/1.5.0/p5.min.js></script>
            <script src=https://cdnjs.cloudflare.com/ajax/libs/p5.js/1.5.0/addons/p5.sound.min.js></script>
            
            
            
            
            
            <script src=&#39;/showcase/js/DeepSet.js&#39;></script> 
            <script>
              
const imgURL = "/showcase/sketches/lenna.png"
const cantidadColores = 4;
const anchoImg = 400;

let img;
let imgCopy;
let coloresDict;
let rgbValues = new DeepSet();
let colores = new DeepSet();
let remplazoColores = []
let altoImg
let slider;
let button;
let esMostrarColores = false;

function preload() {
  // Cargamos la imagen
  img = loadImage(imgURL);
  // Cargamos el diccionario de colores
  coloresDict = loadJSON("/showcase/sketches/colores.json");
  console.log("Colores:", coloresDict)
}

function setup() {
  // Definimos el tamaño del lienzo de P5
  createCanvas(1000, 450);

  altoImg = (anchoImg / img.width) * img.height; 
  image(img, anchoImg, 0, anchoImg, altoImg);
  let c = get();
  
  loadPixels(); 

  calcularColoresWinsor();
  image(c, -anchoImg, 0);  
}


function dibujarColores() {
  let boxWidth = width - anchoImg*2;
  let boxHeight = altoImg / colores.length;

  let x = anchoImg*2 //despues de la imagen
  for (let i = 0; i < colores.length; i++) {
    let rgbValues = extraerRGBdeTexto(colores[i]["rgb"]);
    
    let r = int(rgbValues.r);
    let g = int(rgbValues.g);
    let b = int(rgbValues.b);

    let y = i * boxHeight;
    let c = color(r, g, b);
    fill(c);
    rect(x, y, boxWidth, boxHeight);

    fill(0);
    textAlign(CENTER, CENTER);
    textSize(12);
    text(colores[i]["nombre"], x + boxWidth / 2, y + boxHeight / 2);        
  }
}

function calcularColoresWinsor() {
  posterizar();
  extraerColores();  
   actualizarColores();  
  esMostrarColores = true;
  dibujarColores(); 
}

function posterizar() {
  filter(POSTERIZE, cantidadColores);  
}

function extraerColores() {
  loadPixels(); 
  // Extraer valores RGB en la posición (x, y)
  rgbValues = new DeepSet();
  for (let y = 0; y < img.height; y++) {
    for (let x = 0; x < img.width; x++) {
      // Calcular el indice del pixel en el arreglo de pixeles
      let index = (x + y * img.width) * 4;
      let r = pixels[index]; // valor Red
      let g = pixels[index + 1]; // valor Green
      let b = pixels[index + 2]; // valor Blue 
      let rgbValue = { r: r, g: g, b: b };
      rgbValues.add(rgbValue); // Agregar valores a la lista
    }
  }
  rgbValues = Array.from(rgbValues);
  const uniqueMap = {};
  const uniqueTriples = rgbValues.filter(triple => {
    const key = JSON.stringify(triple);
    console.log(key)
    if (!uniqueMap[key]) {
      uniqueMap[key] = true;
      return true;
    }
    return false;
  });
  console.log(&#39;Valores RGB encontrados:&#39;, rgbValues);
  colores = new DeepSet();
  remplazoColores=[]
  rgbValues.forEach(rgbValue => {
    colorCercano = encontrarColorMasCercano(coloresDict, rgbValue);
    colores.add(colorCercano)
    remplazoColores.push({ org: rgbValue, rem: hexToRgb(colorCercano.hex) })
  });
  colores = Array.from(colores);
  colores.sort((a, b) => {
    aHue = getHueFromHex(a.hex)
    bHue = getHueFromHex(b.hex)
    if (aHue< bHue) {
      return -1;
    }
    if (aHue  > bHue) {
      return 1;
    }
    return 0;    
    });
  console.log("Nombres de los colores encontrados:", colores);
  console.log("Remplazo de colores:", remplazoColores); 
}

function actualizarColores(){  
  loadPixels(); 
  for (let y = 0; y < img.height; y++) {
    for (let x = 0; x < img.width; x++) {
      let index = (x + y * img.width) * 4;
      let r = img.pixels[index]; // valor Red
      let g = img.pixels[index + 1]; // valor Green
      let b = img.pixels[index + 2]; // valor Blue 
      let rgbValue = { r: r, g: g, b: b };
      let colorRemplazo = remplazoColores.find(obj =>
        obj.org.r === rgbValue.r &&
        obj.org.g === rgbValue.g &&
        obj.org.b === rgbValue.b
      );
      if (colorRemplazo) {
        colorRemplazo = colorRemplazo.rem;      
        img.pixels[index] = colorRemplazo.r;
        img.pixels[index + 1] = colorRemplazo.g;
        img.pixels[index + 2] = colorRemplazo.b;
      }
    }
  }
  updatePixels();  
}

function hexToRgb(hex) {
  const r = parseInt(hex.substring(1, 3), 16);
  const g = parseInt(hex.substring(3, 5), 16);
  const b = parseInt(hex.substring(5, 7), 16);
  return { r, g, b };
}

function distanciaRGB(color1, color2) {
  const rDif = color1.r - color2.r;
  const gDif = color1.g - color2.g;
  const bDif = color1.b - color2.b;
  return Math.sqrt(rDif * rDif + gDif * gDif + bDif * bDif);
}

function encontrarColorMasCercano(colors, RGBobjetivo) {
  let colorMasCercano = null;
  let distanciaMasCercana = Infinity;
  Object.values(colors).forEach(color => {
    const colorRgb = hexToRgb(color.hex);
    const distance = distanciaRGB(RGBobjetivo, colorRgb);
    if (distance < distanciaMasCercana) {
      distanciaMasCercana = distance;
      colorMasCercano = color;
    }
  });

  return colorMasCercano;
}

function extraerRGBdeTexto(rgbString) {
  rgbString = rgbString.slice(4, -1);
  let [r, g, b] = rgbString.split(&#39;,&#39;);
  r = parseInt(r);
  g = parseInt(g);
  b = parseInt(b);
  return { r, g, b };
}

function getHueFromHex(hexColor) {
  // Remove the "#" symbol if present
  hexColor = hexColor.replace("#", "");

  // Convert the hex color to RGB values
  const r = parseInt(hexColor.substring(0, 2), 16) / 255;
  const g = parseInt(hexColor.substring(2, 4), 16) / 255;
  const b = parseInt(hexColor.substring(4, 6), 16) / 255;

  // Find the maximum and minimum color component values
  const max = Math.max(r, g, b);
  const min = Math.min(r, g, b);

  // Calculate the hue value
  let hue;
  if (max === min) {
    hue = 0;
  } else {
    const diff = max - min;
    switch (max) {
      case r:
        hue = ((g - b) / diff) % 6;
        break;
      case g:
        hue = (b - r) / diff + 2;
        break;
      case b:
        hue = (r - g) / diff + 4;
        break;
    }
    hue *= 60;
    if (hue < 0) {
      hue += 360;
    }
  }
  return hue;
}


            </script>
          </head>
          <body>
          </body>
        </html>
      '></iframe><p>El diccionario de colores <code>/showcase/sketches/colores.json</code> se generó con el siguiente scrapper de python:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#f92672>import</span> requests
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> json
</span></span><span style=display:flex><span><span style=color:#f92672>from</span> bs4 <span style=color:#f92672>import</span> BeautifulSoup
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>urls <span style=color:#f92672>=</span> [    <span style=color:#e6db74>&#34;https://color-term.com/winsornewton-colors/&#34;</span>,
</span></span><span style=display:flex><span>            <span style=color:#e6db74>&#34;https://color-term.com/winsornewton-colors/2&#34;</span>,
</span></span><span style=display:flex><span>            <span style=color:#e6db74>&#34;https://color-term.com/winsornewton-colors/3&#34;</span>,
</span></span><span style=display:flex><span>            <span style=color:#e6db74>&#34;https://color-term.com/winsornewton-colors/4&#34;</span>,
</span></span><span style=display:flex><span>]
</span></span><span style=display:flex><span>colores <span style=color:#f92672>=</span> []
</span></span><span style=display:flex><span><span style=color:#66d9ef>for</span> url <span style=color:#f92672>in</span> urls:
</span></span><span style=display:flex><span>    response <span style=color:#f92672>=</span> requests<span style=color:#f92672>.</span>get(url)
</span></span><span style=display:flex><span>    soup <span style=color:#f92672>=</span> BeautifulSoup(response<span style=color:#f92672>.</span>content, <span style=color:#e6db74>&#34;html.parser&#34;</span>)
</span></span><span style=display:flex><span>    table <span style=color:#f92672>=</span> soup<span style=color:#f92672>.</span>find(<span style=color:#e6db74>&#34;div&#34;</span>, class_<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;row row-cols-2 row-cols-sm-2 row-cols-md-4 row-cols-lg-5 g-3&#34;</span>)
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>for</span> col <span style=color:#f92672>in</span> table<span style=color:#f92672>.</span>find_all(<span style=color:#e6db74>&#34;div&#34;</span>,class_<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;col&#34;</span>):
</span></span><span style=display:flex><span>        <span style=color:#75715e># Find the cells in each row</span>
</span></span><span style=display:flex><span>        nombre <span style=color:#f92672>=</span> col<span style=color:#f92672>.</span>find(<span style=color:#e6db74>&#34;h2&#34;</span>)<span style=color:#f92672>.</span>text<span style=color:#f92672>.</span>strip()
</span></span><span style=display:flex><span>        hexa <span style=color:#f92672>=</span> col<span style=color:#f92672>.</span>find(<span style=color:#e6db74>&#34;h3&#34;</span>,)<span style=color:#f92672>.</span>text<span style=color:#f92672>.</span>strip()[:<span style=color:#ae81ff>7</span>]
</span></span><span style=display:flex><span>        rgb <span style=color:#f92672>=</span> col<span style=color:#f92672>.</span>find(<span style=color:#e6db74>&#34;h4&#34;</span>,)<span style=color:#f92672>.</span>text<span style=color:#f92672>.</span>strip()
</span></span><span style=display:flex><span>        color <span style=color:#f92672>=</span>  {
</span></span><span style=display:flex><span>          <span style=color:#e6db74>&#34;nombre&#34;</span>: nombre,
</span></span><span style=display:flex><span>          <span style=color:#e6db74>&#34;hex&#34;</span>: hexa,
</span></span><span style=display:flex><span>          <span style=color:#e6db74>&#34;rgb&#34;</span>: rgb
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>        print(color)
</span></span><span style=display:flex><span>        colores<span style=color:#f92672>.</span>append(color)
</span></span><span style=display:flex><span><span style=color:#66d9ef>with</span> open(<span style=color:#e6db74>&#34;colores.json&#34;</span>, <span style=color:#e6db74>&#34;w&#34;</span>) <span style=color:#66d9ef>as</span> f:
</span></span><span style=display:flex><span>    json<span style=color:#f92672>.</span>dump(colores, f)
</span></span></code></pre></div></article><footer class=book-footer><div class="flex flex-wrap justify-between"><div><a class="flex align-center" href=https://github.com/visualcomputing/showcase/commit/b8afa8b17a3dc5c64f3ec85a10ca5af16efe9204 title='Last modified by FredyRosero | May 16, 2023' target=_blank rel=noopener><img src=/showcase/svg/calendar.svg class=book-icon alt=Calendar>
<span>May 16, 2023</span></a></div></div><script>(function(){function e(e){const t=window.getSelection(),n=document.createRange();n.selectNodeContents(e),t.removeAllRanges(),t.addRange(n)}document.querySelectorAll("pre code").forEach(t=>{t.addEventListener("click",function(){if(window.getSelection().toString())return;e(t.parentElement),navigator.clipboard&&navigator.clipboard.writeText(t.parentElement.textContent)})})})()</script></footer><div class=book-comments></div><label for=menu-control class="hidden book-menu-overlay"></label></div><aside class=book-toc><div class=book-toc-content><nav id=TableOfContents><ul><li><a href=#extractor-de-colores-winsor--newton>Extractor de colores Winsor & newton</a></li></ul></nav></div></aside></main></body></html>